- name: Place Pi-hole setup variables
  template:
    src: etc/pihole/setupVars.conf.j2
    dest: /etc/pihole/setupVars.conf
    owner: root
    group: root
    mode: 0644

- name: Install bash
  package:
    name: bash
    state: present

- name: Install curl
  package:
    name: curl
    state: present

- import_tasks: dnscrypt-proxy.yml

- name: Run Pi-hole installation script
  command: curl -sSL https://install.pi-hole.net | bash -s -- --unattended
  args:
    creates: /usr/local/bin/pihole

- import_tasks: dashboard.yml

- import_tasks: ufw.yml
